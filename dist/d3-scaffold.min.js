!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?exports["d3-scaffold"]=e(require("d3")):t["d3-scaffold"]=e(t.d3)}(window,function(t){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=9)}([function(t,e,n){var i=n(10),o=n(12),r=n(13);(e={}).debounce=i,e.isObject=o,e.kebabCase=function(t){return r(t).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},e.deepExtend=function(t){t=t||{};for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var o in i)i.hasOwnProperty(o)&&("object"==typeof i[o]?t[o]=e.deepExtend(t[o],i[o]):t[o]=i[o])}return t},e.extend=function(t){t=t||{};for(var e=1;e<arguments.length;e++)if(arguments[e])for(var n in arguments[e])arguments[e].hasOwnProperty(n)&&(t[n]=arguments[e][n]);return t},t.exports=e},function(t,e,n){var i=n(4),o=n(0),r=n(5),a=function(t,e){var n=this;i.call(this,e),this._updateDimension=function(){var t=n._state.width,e=n._state.height,i=n._state.plates,o=n._state.options.margin;for(var r in n._state.innerWidth=t-o.left-o.right,n._state.innerHeight=e-o.top-o.bottom,n.chartRoot.style("width",t+"px").style("height",e+"px"),i)i[r].copyDimension(n).updateDimensionNow();return n.dispatcher.apply("resize",n,[t,e,n._state.innerWidth,n._state.innerHeight]),n},this._dispatchData=function(){return n.dispatcher.call("data",n,n._state.data),n},this._dispatchOptions=function(){return n.dispatcher.call("options",n,n._state.options),n},this.addPlate=function(t,e,i){if(n.plates[t])throw new Error("Plate with this name already exists",t);return n._state.plates.push(e),n.plates[t]=e,i?n:(e.getSelection().classed("d3-scaffold-plate",!0).style("position","absolute").style("top","0px").style("left","0px"),n.chartRoot.append(function(){return e.getNode()}),n)},this.removePlate=function(t){var e,i=n.plates[t];return i&&((e=n._state.plates.indexOf(i))>-1&&n._state.plates.splice(e,1),i.getNode().parentNode===n.chartRoot.node()&&n.chartRoot.node().removeChild(i.getNode()),delete n.plates[t]),n},this.setupDispatcher=function(t){return n._customEventNames=t||[],n._eventNames=a.DEFAULT_EVENTS.concat(t),n.dispatcher=r.dispatch.apply(n,n._eventNames),n},this.getInnerWidth=function(){return n._state.innerWidth},this.getInnerHeight=function(){return n._state.innerHeight},this.data=function(t){return void 0===t?n._state.data:(n._state.data=t,n._dispatchData(),n)},this.options=function(t){var e;return void 0===t?n._state.options:(e=o.extend({},t),t.margin&&(n.margin(t.margin),delete e.margin),t.offset&&(n.offset(t.offset),delete e.offset),t.pixelRatio&&(n.pixelRatio(t.pixelRatio),delete e.pixelRatio),n._state.options=o.deepExtend(n._state.options,e),n._dispatchOptions(),n)},this.hasData=function(){var t=this._state.data;return null!=t},this.hasNonZeroArea=function(){var t=n._state.innerWidth,e=n._state.innerHeight;return t>0&&e>0},this.on=function(t,e){return n.dispatcher.on(t,e),n},this.off=function(t){return n.dispatcher.on(t,null),n},this.dispatchAs=function(t){return function(){n.dispatcher.apply(t,n,arguments)}},this.destroy=function(){for(var t=0;t<n._eventNames.length;t++)n.off(n._eventNames[t]);return n},function(){o.extend(n._state,{innerWidth:0,innerHeight:0,data:null,plates:[]}),n.container=r.select(t),n.container.style("line-height","0px"),n.chartRoot=n.container.append("div").classed("d3-scaffold-chart-root",!0).style("display","inline-block").style("position","relative").style("line-height","0px"),n.plates={};var e=n.getCustomEventNames();n.setupDispatcher(e),n._dispatchData=o.debounce(n._dispatchData.bind(n),1),n._dispatchOptions=o.debounce(n._dispatchOptions.bind(n),1),n.on("data",function(){n.draw()})}()};a.DEFAULT_EVENTS=["data","options","resize"],a.prototype=Object.create(i.prototype),a.prototype.constructor=a,a.prototype.getCustomEventNames=function(){return[]},a.prototype.draw=function(){},t.exports=a},function(t,e,n){var i=n(4),o=n(5),r=function(t,e){var n=this;i.call(this,e),this.node=t,this.selection=o.select(this.node),this.getNode=function(){return n.node},this.getSelection=function(){return n.selection}};(r.prototype=Object.create(i.prototype)).constructor=r,t.exports=r},function(t,e){t.exports=function(t){return null==t?"":""+t}},function(t,e,n){var i=n(0),o=function(t){var e,n=this;this._updateDimension=function(){return n},this.copyDimension=function(t){if(t){var e=t._state,o=e.options;i.deepExtend(this._state,{width:e.width,height:e.height,options:{offset:o.offset.concat(),margin:o.margin,pixelRatio:o.pixelRatio}}),n._updateDimension()}return n},this.width=function(t){var e;return void 0===t?n._state.width:((e=Math.floor(+t))!==n._state.width&&(n._state.width=e,n._updateDimension()),n)},this.height=function(t){var e;return void 0===t?n._state.height:((e=Math.floor(+t))!==n._state.height&&(n._state.height=e,n._updateDimension()),n)},this.dimension=function(t){return void 0===t?[n._state.width,n._state.height]:((2==t.length?t:null)&&n.width(t[0]).height(t[1]),n)},this.margin=function(t){var e,o,r;if(void 0===t)return n._state.options.margin;for(var a in e=n._state.options.margin,r=!1,o=i.extend({},n._state.options.margin,t))if(e[a]!==o[a]){r=!0;break}return r&&(n._state.options.margin=o,n._updateDimension()),n},this.offset=function(t){var e,i,o;return void 0===t?n._state.options.offset:(e=n._state.options.offset,o=!1,(i=2==t.length?t:null)&&(i[0]===e[0]&&i[1]===e[1]||(o=!0)),o&&(n._state.options.offset=i,n._updateDimension()),n)},this.pixelRatio=function(t){var e;return void 0===t?n._state.options.pixelRatio:((e=+t)!==n._state.options.pixelRatio&&(n._state.options.pixelRatio=e,n._updateDimension()),n)},this.updateDimensionNow=function(){return n._updateDimension(),n},e=i.deepExtend(n.getDefaultOptions(),t),n._state={width:e.width,height:e.height,options:e},n._updateDimension=i.debounce(n._updateDimension.bind(n),1)};o.prototype.getDefaultOptions=function(){return{width:720,height:500,margin:{top:30,right:30,bottom:30,left:30},offset:[.5,.5],pixelRatio:window.devicePixelRatio||1}},t.exports=o},function(e,n){e.exports=t},function(t,e,n){var i=n(2),o=function(t){var e=this;i.call(this,document.createElement("canvas"),t),this._updateDimension=function(){var t=e.width(),n=e.height(),i=e.pixelRatio();return e.node.setAttribute("width",t*i),e.node.setAttribute("height",n*i),e.node.style.width=t+"px",e.node.style.height=n+"px",e},this.getContext2d=function(){var t=e.pixelRatio(),n=e.margin(),i=e.offset(),o=i[0],r=i[1],a=e.node.getContext("2d");return a.setTransform(1,0,0,1,0,0),a.scale(t,t),a.translate(n.left+o,n.top+r),a},this.clear=function(){var t=e.width(),n=e.height(),i=e.pixelRatio(),o=e.node.getContext("2d");return o.setTransform(1,0,0,1,0,0),o.scale(i,i),o.clearRect(0,0,t,n),e}};(o.prototype=Object.create(i.prototype)).constructor=o,t.exports=o},function(t,e,n){var i=n(2),o=n(8),r=function(t){var e=this;i.call(this,document.createElementNS("http://www.w3.org/2000/svg","svg"),t),this.rootG=this.selection.append("g"),this.layers=new o(this.rootG),this._updateDimension=function(){var t=this.width(),n=this.height(),i=e.margin(),o=e.offset(),r=o[0],a=o[1];return e.selection.attr("width",t).attr("height",n),e.rootG.attr("transform","translate("+(i.left+r)+","+(i.top+a)+")"),e}};(r.prototype=Object.create(i.prototype)).constructor=r,t.exports=r},function(t,e,n){var i=n(0);t.exports=function(t,e){var n=e||"g",o=t,r={};function a(t,e,o){o=o||"";var a,s,u=e.split(".");u.length>1?(s=u[0].length>0?u[0]:n,a=u[1]):(s=n,a=u[0]);var c=o+a;if(r.hasOwnProperty(c))throw new Error("Invalid or duplicate layer id:"+c);var p=i.kebabCase(a)+"-layer",f=t.append(s).classed(p,!0);return r[c]=f,f}function s(t){return function t(e,n,o){if(o=o||"",Array.isArray(n))return n.map(function(n){t(e,n,o)});if(i.isObject(n)){var r=Object.keys(n)[0],s=a(e,r,o);return t(s,n[r],o+r+"/"),s}return a(e,n,o)}(o,t)}return{create:function(t){return Array.isArray(t)?t.map(s):s(t)},get:function(t){return r[t]},has:function(t){return!!r[t]}}}},function(t,e,n){(e={}).helper=n(0),e.AbstractChart=n(1),e.CanvasChart=n(16),e.SvgChart=n(17),e.AbstractPlate=n(2),e.CanvasPlate=n(6),e.SvgPlate=n(7),e.LayerOrganizer=n(8),t.exports=e},function(t,e,n){(function(e){var n="Expected a function",i=NaN,o="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt,p="object"==typeof e&&e&&e.Object===Object&&e,f="object"==typeof self&&self&&self.Object===Object&&self,l=p||f||Function("return this")(),d=Object.prototype.toString,h=Math.max,v=Math.min,g=function(){return l.Date.now()};function y(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function m(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&d.call(t)==o}(t))return i;if(y(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=y(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(r,"");var n=s.test(t);return n||u.test(t)?c(t.slice(2),n?2:8):a.test(t)?i:+t}t.exports=function(t,e,i){var o,r,a,s,u,c,p=0,f=!1,l=!1,d=!0;if("function"!=typeof t)throw new TypeError(n);function _(e){var n=o,i=r;return o=r=void 0,p=e,s=t.apply(i,n)}function x(t){var n=t-c;return void 0===c||n>=e||n<0||l&&t-p>=a}function b(){var t=g();if(x(t))return w(t);u=setTimeout(b,function(t){var n=e-(t-c);return l?v(n,a-(t-p)):n}(t))}function w(t){return u=void 0,d&&o?_(t):(o=r=void 0,s)}function O(){var t=g(),n=x(t);if(o=arguments,r=this,c=t,n){if(void 0===u)return function(t){return p=t,u=setTimeout(b,e),f?_(t):s}(c);if(l)return u=setTimeout(b,e),_(c)}return void 0===u&&(u=setTimeout(b,e)),s}return e=m(e)||0,y(i)&&(f=!!i.leading,a=(l="maxWait"in i)?h(m(i.maxWait)||0,e):a,d="trailing"in i?!!i.trailing:d),O.cancel=function(){void 0!==u&&clearTimeout(u),p=0,o=c=r=u=void 0},O.flush=function(){return void 0===u?s:w(g())},O}}).call(this,n(11))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}},function(t,e,n){var i=n(3),o=n(14),r=String.prototype.trim;t.exports=function(t,e){return t=i(t),!e&&r?r.call(t):(e=o(e),t.replace(new RegExp("^"+e+"+|"+e+"+$","g"),""))}},function(t,e,n){var i=n(15);t.exports=function(t){return null==t?"\\s":t.source?t.source:"["+i(t)+"]"}},function(t,e,n){var i=n(3);t.exports=function(t){return i(t).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}},function(t,e,n){var i=n(1),o=n(6),r=function(t,e){var n=this;i.call(this,t,e),this.addPlate("canvas",new o),this.canvas=this.plates.canvas.getSelection(),this.updateDimensionNow(),this.getContext2d=function(){return n.plates.canvas.getContext2d()},this.clear=function(){return n.plates.canvas.clear(),n}};(r.prototype=Object.create(i.prototype)).constructor=r,t.exports=r},function(t,e,n){var i=n(1),o=n(7),r=function(t,e){var n=this;i.call(this,t,e),function(){n.addPlate("svg",new o);var t=n.plates.svg;n.svg=t.getSelection(),n.rootG=t.rootG,n.layers=t.layers,n.updateDimensionNow()}()};(r.prototype=Object.create(i.prototype)).constructor=r,t.exports=r}])});